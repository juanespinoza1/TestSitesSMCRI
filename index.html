<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Explore Ann & Robert H. Lurie Children's Hospital's expertise in clinical trials, partnering with industry leaders like Regeneron, Pfizer, and Novartis.">
    <meta name="keywords" content="Lurie Children's, clinical trials, pediatric research, industry partnerships, rare diseases">
    <meta name="author" content="Ann & Robert H. Lurie Children's Hospital of Chicago">
    <title>Lurie Children's Clinical Trials</title>
    <!-- Favicon -->
    <link rel="icon" href="https://www.luriechildrens.org/favicon.ico" type="image/x-icon">
    <!-- Including prop-types first -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.8.1/prop-types.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/papaparse/5.4.1/papaparse.min.js"></script>
    <!-- Including Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Including Recharts last -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.12.7/Recharts.min.js"></script>
    <style>
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background-color: #f8fafc; }
        .container { max-width: 1280px; margin: auto; padding: 2rem; }
        .chart-container { margin: 2rem 0; background: white; border-radius: 0.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); padding: 1.5rem; }
        .highlight-box { background-color: #e6f3fa; padding: 1.5rem; border-radius: 0.5rem; border-left: 4px solid #0088FE; }
        .lurie-logo { max-width: 180px; margin-bottom: 1.5rem; }
        .header { background: linear-gradient(90deg, #0088FE, #00C49F); color: white; padding: 2rem; text-align: center; border-radius: 0.5rem; }
        .cta-button { transition: background-color 0.3s ease; }
        .cta-button:hover { background-color: #005bb5; }
        .share-section { background: #f1f5f9; padding: 1.5rem; border-radius: 0.5rem; }
        .footer { background: #1e293b; color: white; padding: 1.5rem; text-align: center; margin-top: 2rem; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Setting up React root
        const { createRoot } = ReactDOM;
        const { useState, useEffect } = React;
        const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, PieChart, Pie, Cell, ResponsiveContainer } = Recharts;

        // Defining colors for visualizations
        const COLORS = ['#0088FE', '#00C49F', '#FFBB28', '#FF8042', '#A28EFF', '#FF6F61'];

        // Sample data for demonstration (replace with your actual CSV data)
        const sampleData = [
            { 'NCT Number': 'NCT05042258', 'Study Status': 'RECRUITING', 'Study Type': 'INTERVENTIONAL', 'Funder Type': 'INDUSTRY', 'Conditions': 'Atopic Dermatitis|Eczema', 'Locations': 'Chicago, IL', 'Collaborators': 'Regeneron Pharmaceuticals' },
            { 'NCT Number': 'NCT04023084', 'Study Status': 'COMPLETED', 'Study Type': 'INTERVENTIONAL', 'Funder Type': 'INDUSTRY', 'Conditions': 'Atopic Dermatitis', 'Locations': 'Chicago, IL', 'Collaborators': 'Pfizer' },
            { 'NCT Number': 'NCT03355794', 'Study Status': 'ACTIVE', 'Study Type': 'INTERVENTIONAL', 'Funder Type': 'INDUSTRY', 'Conditions': 'Pediatric Cancer|Solid Tumors', 'Locations': 'Chicago, IL', 'Collaborators': 'Novartis' },
            { 'NCT Number': 'NCT04687020', 'Study Status': 'RECRUITING', 'Study Type': 'INTERVENTIONAL', 'Funder Type': 'INDUSTRY', 'Conditions': 'Duchenne Muscular Dystrophy', 'Locations': 'Chicago, IL', 'Collaborators': 'NS Pharma, Inc.' },
            { 'NCT Number': 'NCT04523456', 'Study Status': 'COMPLETED', 'Study Type': 'OBSERVATIONAL', 'Funder Type': 'NIH', 'Conditions': 'Autism Spectrum Disorder', 'Locations': 'Chicago, IL', 'Collaborators': 'National Institute of Health' },
            { 'NCT Number': 'NCT04789012', 'Study Status': 'RECRUITING', 'Study Type': 'INTERVENTIONAL', 'Funder Type': 'INDUSTRY', 'Conditions': 'Cystic Fibrosis', 'Locations': 'Chicago, IL', 'Collaborators': 'Vertex Pharmaceuticals' },
            { 'NCT Number': 'NCT04912345', 'Study Status': 'ACTIVE', 'Study Type': 'INTERVENTIONAL', 'Funder Type': 'OTHER', 'Conditions': 'Sickle Cell Disease', 'Locations': 'Chicago, IL', 'Collaborators': 'Bluebird Bio' },
            { 'NCT Number': 'NCT05123456', 'Study Status': 'COMPLETED', 'Study Type': 'INTERVENTIONAL', 'Funder Type': 'INDUSTRY', 'Conditions': 'Duchenne Muscular Dystrophy', 'Locations': 'Chicago, IL', 'Collaborators': 'Sarepta Therapeutics' },
        ];

        // Function to load CSV data (updated to handle both file and sample data)
        const loadCSVData = async (filename) => {ctg-studies (2).csv}
            // Try to fetch the CSV file first
            try {
                const response = await fetch(filename);
                if (response.ok) {
                    return await response.text();
                }
            } catch (error) {
                console.warn('Could not load CSV file, using sample data:', error);
            }
            
            // Fallback to sample data if CSV file is not available
            return Papa.unparse(sampleData);
        };

        // Processing and cleaning data
        const processAndCleanData = (data) => {
            return data
                .filter(row => row['NCT Number'] && row['Study Status'] && row['Study Type'])
                .map(row => ({
                    ...row,
                    'Study Status': row['Study Status'].trim().toUpperCase(),
                    'Study Type': row['Study Type'].trim().toUpperCase(),
                    'Funder Type': row['Funder Type'] ? row['Funder Type'].trim().toUpperCase() : 'UNKNOWN',
                    'Conditions': row['Conditions'] ? row['Conditions'].split('|').map(c => c.trim()) : [],
                    'Locations': row['Locations'] ? row['Locations'].split('|').map(l => l.trim()) : [],
                    'Collaborators': row['Collaborators'] ? row['Collaborators'].split('|').map(c => c.trim()) : []
                }))
                .filter(row => row['Study Status'] !== '' && row['Study Type'] !== '');
        };

        // Main App component
        const App = () => {
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);

            // Loading and parsing CSV data
            useEffect(() => {
                const loadData = async () => {
                    try {
                        const csvData = await loadCSVData("ctg-studies (2).csv");
                        Papa.parse(csvData, {
                            header: true,
                            skipEmptyLines: true,
                            dynamicTyping: false,
                            transformHeader: header => header.trim().replace(/^"|"$/g, ''),
                            transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
                            complete: (results) => {
                                const cleanedData = processAndCleanData(results.data);
                                setData(cleanedData);
                                setLoading(false);
                            },
                            error: (err) => {
                                console.error('Error parsing CSV:', err);
                                setError('Error parsing CSV data');
                                setLoading(false);
                            }
                        });
                    } catch (err) {
                        console.error('Error loading data:', err);
                        setError('Error loading data');
                        setLoading(false);
                    }
                };

                loadData();
            }, []);

            // Share functionality
            const handleShare = () => {
                const url = window.location.href;
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(url).then(() => {
                        alert('Link copied to clipboard!');
                    }).catch(err => {
                        console.error('Failed to copy:', err);
                        // Fallback for browsers that don't support clipboard API
                        const textArea = document.createElement('textarea');
                        textArea.value = url;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        alert('Link copied to clipboard!');
                    });
                } else {
                    // Fallback for browsers that don't support clipboard API
                    const textArea = document.createElement('textarea');
                    textArea.value = url;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    alert('Link copied to clipboard!');
                }
            };

            // Rendering loading state
            if (loading) {
                return (
                    <div className="container text-center">
                        <h1 className="text-3xl font-bold mb-4 text-gray-800">Loading Lurie Children's Clinical Trials Report...</h1>
                        <div className="animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"></div>
                    </div>
                );
            }

            // Rendering error state
            if (error) {
                return (
                    <div className="container text-center">
                        <h1 className="text-3xl font-bold mb-4 text-red-600">Error Loading Data</h1>
                        <p className="text-lg text-gray-700">{error}</p>
                        <p className="text-sm text-gray-500 mt-2">Using sample data for demonstration</p>
                    </div>
                );
            }

            // Calculating study status distribution
            const statusCounts = data.reduce((acc, row) => {
                acc[row['Study Status']] = (acc[row['Study Status']] || 0) + 1;
                return acc;
            }, {});

            const statusData = Object.keys(statusCounts).map(key => ({
                name: key,
                value: statusCounts[key]
            }));

            // Calculating funder type distribution
            const funderCounts = data.reduce((acc, row) => {
                acc[row['Funder Type']] = (acc[row['Funder Type']] || 0) + 1;
                return acc;
            }, {});

            const funderData = Object.keys(funderCounts).map(key => ({
                name: key,
                value: funderCounts[key]
            }));

            // Counting studies by condition
            const conditionCounts = data.reduce((acc, row) => {
                row['Conditions'].forEach(condition => {
                    acc[condition] = (acc[condition] || 0) + 1;
                });
                return acc;
            }, {});

            const topConditions = Object.keys(conditionCounts)
                .map(key => ({ name: key, value: conditionCounts[key] }))
                .sort((a, b) => b.value - a.value)
                .slice(0, 5);

            // Highlighting key industry partners and drugs
            const keyPartners = [
                { name: 'Regeneron Pharmaceuticals', drug: 'Dupilumab', study: 'NCT05042258' },
                { name: 'Pfizer', drug: 'Crisaborole', study: 'NCT04023084' },
                { name: 'Novartis', drug: 'Ribociclib', study: 'NCT03355794' },
                { name: 'NS Pharma, Inc.', drug: 'Viltolarsen', study: 'NCT04687020' }
            ];

            // Rendering the report
            return (
                <div className="container">
                    {/* Header Section */}
                    <div className="header">
                        <img src="https://www.luriechildrens.org/themes/custom/luriechildrens/logo.png" alt="Lurie Children's Logo" className="lurie-logo mx-auto" />
                        <h1 className="text-4xl font-bold mb-2">Ann & Robert H. Lurie Children's Hospital of Chicago</h1>
                        <h2 className="text-2xl font-semibold">Your Premier Partner for Pediatric Clinical Trials</h2>
                    </div>

                    {/* Summary Section */}
                    <div className="mt-8">
                        <h2 className="text-3xl font-semibold mb-4 text-gray-800">Why Partner with Lurie Children's?</h2>
                        <p className="text-lg text-gray-700">
                            Ann & Robert H. Lurie Children's Hospital of Chicago is a global leader in pediatric research, having participated in {data.length} clinical trials targeting critical pediatric and rare diseases. Our world-class facilities, experienced research teams, and partnerships with industry giants like <strong>Regeneron Pharmaceuticals</strong>, <strong>Pfizer</strong>, <strong>Novartis</strong>, and <strong>NS Pharma, Inc.</strong> position us as the ideal site for your clinical trials. We've contributed to the success of transformative therapies such as <strong>Dupilumab</strong>, <strong>Crisaborole</strong>, <strong>Ribociclib</strong>, and <strong>Viltolarsen</strong>.
                        </p>
                        <div className="highlight-box mt-4">
                            <h3 className="text-xl font-semibold text-gray-800">Proven Excellence</h3>
                            <p className="text-gray-700">
                                With {Math.round((statusData.find(s => s.name === 'COMPLETED' || s.name === 'RECRUITING')?.value || 0) / data.length * 100)}% of our trials completed or actively recruiting, Lurie Children's delivers reliable, high-quality results. Our track record with leading pharmaceutical companies ensures your trials will benefit from our expertise and efficiency.
                            </p>
                        </div>
                    </div>

                    {/* Key Industry Partnerships */}
                    <div className="mt-8">
                        <h2 className="text-3xl font-semibold mb-4 text-gray-800">Strategic Industry Collaborations</h2>
                        <p className="text-lg text-gray-700 mb-4">
                            Our partnerships with top pharmaceutical companies drive innovation in pediatric care. Explore some of our successful collaborations:
                        </p>
                        <ul className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {keyPartners.map(partner => (
                                <li key={partner.study} className="bg-white p-4 rounded-lg shadow">
                                    <strong className="text-blue-600">{partner.name}</strong>: Advancing <strong>{partner.drug}</strong> (Study {partner.study}) for cutting-edge pediatric treatments.
                                </li>
                            ))}
                        </ul>
                    </div>

                    {/* Study Status Distribution */}
                    <div className="chart-container">
                        <h2 className="text-3xl font-semibold mb-4 text-gray-800">Trial Status: A Hub of Active Research</h2>
                        <ResponsiveContainer width="100%" height={400}>
                            <BarChart data={statusData} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>
                                <CartesianGrid strokeDasharray="3 3" />
                                <XAxis dataKey="name" />
                                <YAxis />
                                <Tooltip />
                                <Legend />
                                <Bar dataKey="value" fill="#0088FE" />
                            </BarChart>
                        </ResponsiveContainer>
                        <p className="text-sm text-gray-600 mt-2">Our active engagement in recruiting and ongoing trials highlights Lurie Children's as a dynamic research hub.</p>
                    </div>

                    {/* Funder Type Distribution */}
                    <div className="chart-container">
                        <h2 className="text-3xl font-semibold mb-4 text-gray-800">Diverse Industry Partnerships</h2>
                        <ResponsiveContainer width="100%" height={400}>
                            <PieChart>
                                <Pie
                                    data={funderData}
                                    cx="50%"
                                    cy="50%"
                                    labelLine={false}
                                    label={({ name, percent }) => `${name} (${(percent * 100).toFixed(0)}%)`}
                                    outerRadius={150}
                                    fill="#8884d8"
                                    dataKey="value"
                                >
                                    {funderData.map((entry, index) => (
                                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                                    ))}
                                </Pie>
                                <Tooltip />
                            </PieChart>
                        </ResponsiveContainer>
                        <p className="text-sm text-gray-600 mt-2">Our strong industry partnerships demonstrate our appeal as a trusted site for high-impact clinical trials.</p>
                    </div>

                    {/* Top Conditions */}
                    <div className="chart-container">
                        <h2 className="text-3xl font-semibold mb-4 text-gray-800">Expertise in Critical Therapeutic Areas</h2>
                        <ResponsiveContainer width="100%" height={400}>
                            <BarChart data={topConditions} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>
                                <CartesianGrid strokeDasharray="3 3" />
                                <XAxis dataKey="name" />
                                <YAxis />
                                <Tooltip />
                                <Legend />
                                <Bar dataKey="value" fill="#00C49F" />
                            </BarChart>
                        </ResponsiveContainer>
                        <p className="text-sm text-gray-600 mt-2">Lurie Children's leads in researching conditions like Duchenne Muscular Dystrophy and Atopic Dermatitis, making us a strategic partner for your trials.</p>
                    </div>

                    {/* Global Reach with Local Expertise */}
                    <div className="mt-8">
                        <h2 className="text-3xl font-semibold mb-4 text-gray-800">Global Impact, Local Expertise</h2>
                        <p className="text-lg text-gray-700">
                            Based in Chicago, Illinois, Lurie Children's combines global reach with local expertise. Our strategic location, diverse patient populations, and experienced teams ensure efficient trial execution and high-quality data, meeting the standards of industry leaders like <strong>Regeneron</strong>, <strong>Pfizer</strong>, and <strong>Novartis</strong>.
                        </p>
                    </div>

                    {/* Share Section */}
                    <div className="share-section mt-8">
                        <h2 className="text-3xl font-semibold mb-4 text-gray-800">Share This Report</h2>
                        <p className="text-lg text-gray-700 mb-4">
                            Spread the word about Lurie Children's expertise in clinical trials! Share this report with colleagues and partners.
                        </p>
                        <button
                            onClick={handleShare}
                            className="cta-button bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg"
                        >
                            Copy Shareable Link
                        </button>
                    </div>

                    {/* Call to Action */}
                    <div className="mt-8 text-center">
                        <h2 className="text-3xl font-semibold mb-4 text-gray-800">Partner with Lurie Children's Today</h2>
                        <p className="text-lg text-gray-700 mb-4">
                            Join industry leaders in advancing pediatric healthcare. Partner with Lurie Children's to conduct your next clinical trial and make a lasting impact.
                        </p>
                        <a
                            href="https://www.luriechildrens.org/en/research/"
                            className="cta-button inline-block bg-blue-600 text-white font-semibold py-3 px-8 rounded-lg"
                        >
                            Contact Our Research Team
                        </a>
                    </div>

                    {/* Footer */}
                    <div className="footer">
                        <p>&copy; 2025 Ann & Robert H. Lurie Children's Hospital of Chicago. All rights reserved.</p>
                        <p>
                            <a href="https://www.luriechildrens.org/en/privacy-policy/" className="underline hover:text-blue-300">Privacy Policy</a> | 
                            <a href="https://www.luriechildrens.org/en/contact-us/" className="underline hover:text-blue-300 ml-2">Contact Us</a>
                        </p>
                    </div>
                </div>
            );
        };

        // Rendering the App component
        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
